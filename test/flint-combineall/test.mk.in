SQLITE3 = sqlite3 -batch -noheader -separator ' '

.PHONY: all clean check check-name check-value check-function check-ode

all: OUTPUT

clean:
	-rm -f UUID.db UUID.xml OUTPUT.value OUTPUT.function OUTPUT.ode OUTPUT.db

check: check-name check-value check-function check-ode

check-name: NAME OUTPUT
	($(SQLITE3) OUTPUT.db 'SELECT space_id, type, id, name FROM private_names' | diff -u $< -)

check-value: VALUE OUTPUT.value
	diff -u $^

check-function: FUNCTION OUTPUT.function
	diff -u $^

check-ode: ODE OUTPUT.ode
	diff -u $^

OUTPUT: OUTPUT.db
	flint-combineall $< OUTPUT.value OUTPUT.function OUTPUT.ode
	touch $@

OUTPUT.db: MODEL
	test-input1 $@ $<
	flint-phml $@
