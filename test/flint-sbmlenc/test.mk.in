.PHONY: all clean check

all: OUTPUT/run

check: OUTPUT/name.diff OUTPUT/value.diff OUTPUT/function.diff OUTPUT/ode.diff

clean:
	-rm -rf OUTPUT

OUTPUT:
	mkdir -p $@

OUTPUT/db: INPUT | OUTPUT
	test-input1 $@ $<

OUTPUT/sbml: OUTPUT/db
	flint-sbml $< > $@

OUTPUT/run: OUTPUT/sbml
	flint-sbmlenc $< OUTPUT/name OUTPUT/value OUTPUT/function OUTPUT/ode > $@

OUTPUT/name OUTPUT/value OUTPUT/function OUTPUT/ode: OUTPUT/run

OUTPUT/name.diff: EXPECTED/name.o.txt OUTPUT/name
	diff -u $^ > $@

OUTPUT/value.diff: EXPECTED/value.o.txt OUTPUT/value
	diff -u $^ > $@

OUTPUT/function.diff: EXPECTED/function.o.txt OUTPUT/function
	diff -u $^ > $@

OUTPUT/ode.diff: EXPECTED/ode.o.txt OUTPUT/ode
	diff -u $^ > $@
